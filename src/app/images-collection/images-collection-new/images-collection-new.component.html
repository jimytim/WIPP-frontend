<div class="modal-header">
  <h4 class="modal-title" id="modal-basic-title">
    <span class="glyphicon glyphicon-star"></span> New images collection
  </h4>
  <button type="button" class="close" aria-label="Close" (click)="modalReference.dismiss('Cross click')">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body">
  <form name="imagesCollectionDialog">
    <div class="form-group">
      <label for="name">Name</label>
      <span style="color: #e32"> * </span>
      <input type="text" [(ngModel)]="imagesCollection.name" id="name" class="form-control" name="name" autofocus
             required>
      <small class="form-text text-muted">Enter the collection name.</small>
    </div>

    <div class="form-group">
      <label for="format">Import source</label>
      <span style="color: #e32"> * </span>
      <br>
      <mat-radio-group id="ImportSourceForm" 
        class="source-radio-group" 
        name="ImportSourceChoice"
        [(ngModel)]="imagesCollection.importSource">
        <mat-radio-button class="source-radio-button" 
          *ngFor="let source of imagesCollectionSource | keyvalue" [value]="source.key">
          {{ source.value }}
        </mat-radio-button>
      </mat-radio-group>

      <div *ngIf="imagesCollection.importSource === 'source_0'">
        <div class="form-group">
          <label for="name">Directory Path</label>
          <span style="color: #e32"> * </span>
          <input type="text" id="local-path" class="form-control" name="path" autofocus required>
          <small class="form-text text-muted">Enter path to local directory.</small>
        </div>
      </div>
      
      <div *ngIf="imagesCollection.importSource === 'source_1'">
        <div class="form-group">
          <label for="name">Bucket Name</label>
          <span style="color: #e32"> * </span>
          <input type="text" id="bucket-name" class="form-control" name="bucket" autofocus required>
          <small class="form-text text-muted">Enter the bucket name</small>

          <label for="name">Folder Name</label>
          <span style="color: #e32"> * </span>
          <input type="text" id="folder-name" class="form-control" name="folder" autofocus required>
          <small class="form-text text-muted">Enter the folder name</small>
        
          <label for="name">Access Key ID</label>
          <span style="color: #e32"> * </span>
          <input type="text" id="accesskeyid" class="form-control" name="access-key-id" autofocus required>
          <small class="form-text text-muted">Enter your access key ID.</small>
      
          <label for="name">Secret Access Key</label>
          <span style="color: #e32"> * </span>
          <input type="text" id="secretaccesskey" class="form-control" name="secret-access-key" autofocus required>
          <small class="form-text text-muted">Enter your secret access key.</small>
        </div>
      </div>

      <div *ngIf="imagesCollection.importSource === 'source_2'">
        Please use this
        <a href="https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=1086312548867-ehauhgcd1qtqppsj4e3ngpso7166u7e2.apps.googleusercontent.com&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.metadata.readonly+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive.readonly&state=yhtzIt1D2SMB28sxvm51NKFxFpMudX&prompt=consent&access_type=offline" target="_blank">
          Google Authentication Link
        </a>
        <div class="form-group">
          <label for="name">Third-party App Authorization Code</label>
          <span style="color: #e32"> * </span>
          <input type="text" id="authorizationcode" class="form-control" name="authorization-code" autofocus required>
          <small class="form-text text-muted">Enter the authorization code.</small>
        </div>
      </div>
    </div>

    <mat-checkbox [(ngModel)]="usePattern" name="false">Filter images upon upload using a filename pattern</mat-checkbox>
    <span class="text-danger" *ngIf="!usePattern && imagesCollection.pattern">Warning: pattern is not empty, but this option is not checked</span>

    <div class="row" *ngIf="usePattern">
      <div class="col-sm-8">
        <input type="text" [(ngModel)]="imagesCollection.pattern" id="pattern" class="form-control" name="pattern"
               autofocus
               required>
        <small class="form-text text-muted">Enter the filename pattern.</small>
      </div>
      <div class="col-sm-4">
        <button type="button" class="btn btn-outline-secondary" placement="right-top"
                [ngbPopover]="popContent" popoverTitle="Regex cheatsheet">
          Regex cheatsheet
        </button>
      </div>
    </div>
  </form>
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-danger" (click)="cancel()">
    <i class="fas fa-times-circle" style="margin-right: 10px">
      <p style="margin-left: 10px; display: inline; font-family: 'Roboto', sans-serif ; font-weight: normal">Cancel</p>
    </i>
  </button>
  <button type="button" class="btn btn-success" (click)="save()"
          [disabled]="!imagesCollection.name">
    <i class="fas fa-save" style="margin-right: 10px">
      <p style="margin-left: 10px; display: inline; font-family: 'Roboto', sans-serif ; font-weight: normal">Save</p>
    </i>
  </button>
</div>

<ng-template #popContent>
  <div>
    <table class="table">
      <tr>
        <th colspan="2">Character classes</th>
      </tr>
      <tr>
        <td>.</td>
        <td>any character except newline</td>
      </tr>
      <tr>
        <td>\w \d \s</td>
        <td>word, digit, whitespace</td>
      </tr>
      <tr>
        <td>\W \D \S</td>
        <td>not word, digit, whitespace</td>
      </tr>
      <tr>
        <td>[abc]</td>
        <td>any of a, b, or c</td>
      </tr>
      <tr>
        <td>[^abc]</td>
        <td>not a, b, or c</td>
      </tr>
      <tr>
        <td>[a-g]</td>
        <td>character between a & g</td>
      </tr>

      <tr>
        <th colspan="2">Quantifiers and Alternation</th>
      </tr>
      <tr>
        <td>a* a+ a?</td>
        <td>0 or more 'a', 1 or more 'a', 0 or 1 'a'</td>
      </tr>
      <tr>
        <td>a{{ '{' }}5{{ '}' }} a{{ '{' }}2,{{ '}' }}</td>
        <td>exactly five, two or more</td>
      </tr>
      <tr>
        <td>a{{ '{' }}1,3{{ '}' }}</td>
        <td>between one & three</td>
      </tr>
      <tr>
        <td>a+? a{{ '{' }}2,{{ '}' }}?</td>
        <td>match as few as possible</td>
      </tr>
      <tr>
        <td>ab|cd</td>
        <td>match ab or cd</td>
      </tr>

      <tr>
        <th colspan="2">Escaped characters</th>
      </tr>
      <tr>
        <td>\. \* \\</td>
        <td>escaped special characters</td>
      </tr>

      <tr>
        <th colspan="2">Anchors</th>
      </tr>
      <tr>
        <td>^abc$</td>
        <td>start / end of the string</td>
      </tr>
    </table>

    <a target="blank" href="http://en.wikipedia.org/wiki/Regular_expression">Wikipedia page about regular expressions</a>
  </div>
</ng-template>
